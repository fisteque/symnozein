<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Deník a spirála vědomí</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 2rem;
    }
    .entry-link {
      display: block;
      margin-bottom: 1.5rem;
      text-decoration: none;
      color: inherit;
      border-left: 4px solid #ccc;
      padding-left: 1rem;
    }
    .entry-link:hover {
      border-color: #666;
    }
    h2 {
      margin-top: 3rem;
    }
  </style>
</head>
<body>
  <h1>Symnózein – deník a spirála vědomí</h1>

  <h2>Spirála vědomí</h2>
  <div id="spirala-entries"></div>

  <h2>Deníkové záznamy</h2>
  <div id="denik-entries"></div>

  <script>
    async function fetchAndRender(jsonUrl, containerId, usePath = false) {
      try {
        const response = await fetch(jsonUrl);
        const data = await response.json();

        // Pokud je to objekt s .entries (např. spirála), převeď na pole
        const entries = Array.isArray(data) ? data : data.entries;

        const container = document.getElementById(containerId);

        entries
          .filter(entry => entry.hidden !== true)
          .sort((a, b) => new Date(b.date) - new Date(a.date))
          .forEach(entry => {
            const link = document.createElement('a');
            link.className = 'entry-link';
            link.href = usePath ? entry.path : entry.file;

            const title = document.createElement('h3');
            title.textContent = entry.title || 'Bez názvu';

            const summary = document.createElement('p');
            summary.textContent = entry.summary || '';

            link.appendChild(title);
            link.appendChild(summary);
            container.appendChild(link);
          });

      } catch (error) {
        console.error('Chyba při načítání nebo zobrazení:', error);
      }
    }

    // Zobraz spirálu i deník
    fetchAndRender('spirala_index.json', 'spirala-entries', true);
    fetchAndRender('denik_index.json', 'denik-entries');
  </script>
</body>
</html>
